# Linux Malware Analysis Techniques

**対応OS**: Linux

## 概要
Linux環境でのマルウェア解析手法について解説します。

## 基本的な手法

### 静的解析
```bash
# ファイルハッシュの取得
sha256sum malware

# ELF解析
readelf -a malware
objdump -d malware

# 文字列抽出
strings -a malware | grep -i "http"

# 依存関係の確認
ldd malware
```

### 動的解析
```bash
# システムコール監視
strace -f ./malware

# ネットワーク監視
tcpdump -i any -w capture.pcap
tshark -r capture.pcap

# ファイルシステム監視
inotifywait -m -r /

# プロセス監視
ps aux
top
htop
```

### フォレンジック解析
```python
# Volatilityを使用したメモリ解析
from volatility.framework import contexts
from volatility.framework.automagic import linux

context = contexts.Context()
config = {'linux.LinuxSymbolFinder.system_map': '/boot/System.map'}

# プロセス一覧の取得
plugin = linux.pslist.PsList(context, config)
for task in plugin.list_tasks():
    print(f"PID: {task.pid} Name: {task.comm}")

# ネットワーク接続の解析
plugin = linux.netstat.Netstat(context, config)
for conn in plugin.calculate():
    print(f"Proto: {conn.proto} Local: {conn.local} Remote: {conn.remote}")
```

## 検知回避テクニック
- ptrace検知回避
- ファイルシステム監視回避
- プロセス隠蔽
- ネットワークトラフィック暗号化

## 防御策
- AppArmor/SELinux
- システムコール制限
- ネットワーク分離
- ファイルアクセス制限

## 検知方法
- シグネチャベース検知
- 挙動ベース検知
- ネットワーク異常検知
- ファイルシステム監視

## 注意事項
- このテクニックは教育目的でのみ使用してください
- 実環境での使用は法的責任を伴う可能性があります
- すべてのテストは許可された環境でのみ行ってください 